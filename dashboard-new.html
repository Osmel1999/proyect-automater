<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - KDS Platform</title>
  <meta name="description" content="Configuraci√≥n y gesti√≥n de tu restaurante">
  <link rel="icon" type="image/png" href="assets/images/kds-logo.png">
  
  <!-- Dashboard Styles -->
  <link rel="stylesheet" href="css/dashboard-modern.css">
</head>
<body>
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="sidebar-logo">
        <img src="assets/images/kds-logo.png" alt="KDS Logo" class="logo-img">
        <span class="logo-text">KDS</span>
      </div>
    </div>

    <nav class="sidebar-nav">
      <div class="nav-section">
        <span class="nav-section-title">MEN√ö</span>
        <a href="#" class="nav-item active">
          <span class="nav-icon">üìä</span>
          <span class="nav-text">Dashboard</span>
        </a>
        <a href="#" class="nav-item">
          <span class="nav-icon">üìã</span>
          <span class="nav-text">Tareas</span>
          <span class="nav-badge">03</span>
        </a>
        <a href="/kds.html" class="nav-item" id="kdsBtn">
          <span class="nav-icon">üì∫</span>
          <span class="nav-text">KDS Display</span>
        </a>
        <a href="#" class="nav-item">
          <span class="nav-icon">üìà</span>
          <span class="nav-text">Analytics</span>
        </a>
        <a href="#" class="nav-item">
          <span class="nav-icon">üë•</span>
          <span class="nav-text">Equipo</span>
        </a>
      </div>

      <div class="nav-section">
        <span class="nav-section-title">GENERAL</span>
        <a href="#" class="nav-item">
          <span class="nav-icon">‚öôÔ∏è</span>
          <span class="nav-text">Configuraci√≥n</span>
        </a>
        <a href="#" class="nav-item">
          <span class="nav-icon">‚ùì</span>
          <span class="nav-text">Ayuda</span>
        </a>
        <a href="/select.html" class="nav-item">
          <span class="nav-icon">üö™</span>
          <span class="nav-text">Salir</span>
        </a>
      </div>
    </nav>

    <div class="sidebar-footer">
      <div class="sidebar-app-promo">
        <div class="app-promo-icon">üì±</div>
        <div class="app-promo-content">
          <p class="app-promo-title">Descarga nuestra app m√≥vil</p>
          <p class="app-promo-subtitle">Disponible en iOS y Android</p>
        </div>
        <button class="app-promo-btn">Descargar</button>
      </div>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Header -->
    <header class="top-header">
      <div class="header-search">
        <span class="search-icon">üîç</span>
        <input type="text" placeholder="Buscar tarea" class="search-input">
        <kbd class="search-kbd">‚åò F</kbd>
      </div>

      <div class="header-actions">
        <!-- WhatsApp Status (mantener IDs originales) -->
        <div class="whatsapp-status-modern disconnected" id="whatsapp-status" style="display: none;">
          <span class="status-dot-modern disconnected" id="status-dot"></span>
          <span id="status-text">Desconectado</span>
        </div>
        
        <!-- Disconnect WhatsApp Button -->
        <button class="header-btn-disconnect" id="btn-disconnect-whatsapp" style="display: none;" onclick="disconnectWhatsApp()">
          <span>üì±</span>
          <span>Desconectar</span>
        </button>
        
        <!-- Connect WhatsApp Button -->
        <button class="header-btn-connect" id="btn-connect-whatsapp" style="display: none;" onclick="connectWhatsApp()">
          <span>üì±</span>
          <span>Conectar WhatsApp</span>
        </button>

        <button class="icon-btn">
          <span>üìß</span>
        </button>
        <button class="icon-btn">
          <span>üîî</span>
        </button>
        <div class="user-menu">
          <img src="https://ui-avatars.com/api/?name=Usuario&background=1a5f7a&color=fff" alt="User" class="user-avatar">
          <div class="user-info">
            <span class="user-name" id="tenant-name">Cargando...</span>
            <span class="user-email">usuario@kds.com</span>
          </div>
        </div>
      </div>
    </header>

    <!-- Dashboard Content -->
    <div class="dashboard-container">
      <!-- Loading State (mantener ID original) -->
      <div id="loading-container" class="loading-modern">
        <div class="spinner-modern"></div>
        <p>Cargando tu configuraci√≥n...</p>
      </div>

      <!-- Page Header -->
      <div class="page-header" style="display: none;" id="page-header-main">
        <div>
          <h1 class="page-title">Dashboard</h1>
          <p class="page-subtitle">Planifica, prioriza y gestiona tu negocio con facilidad.</p>
        </div>
        <div class="page-actions">
          <button class="btn-outline" onclick="skipOnboarding()">Importar Datos</button>
          <button class="btn-primary-modern" onclick="openMenuConfig()">
            <span>+</span>
            <span>Agregar Producto</span>
          </button>
        </div>
      </div>

      <!-- Bot Control Card (mantener IDs originales) -->
      <div id="bot-control-container" style="display: none;">
        <div class="bot-control-modern" id="bot-control-card">
          <div class="bot-control-left">
            <div class="bot-icon-modern" id="bot-control-icon">ü§ñ</div>
            <div class="bot-info">
              <h3 class="bot-title">Bot de WhatsApp</h3>
              <p class="bot-subtitle" id="bot-status-text">
                <span class="status-dot-inline"></span>
                <span id="bot-status-label">Cargando...</span>
              </p>
            </div>
          </div>
          <div class="bot-control-right">
            <label class="toggle-switch">
              <input type="checkbox" id="bot-toggle-input" onclick="toggleBot()">
              <span class="toggle-slider"></span>
            </label>
            <span class="toggle-label" id="bot-toggle-label">OFF</span>
          </div>
        </div>

        <!-- Warning (mantener ID original) -->
        <div class="alert-modern alert-warning" id="bot-warning" style="display: none;">
          <span class="alert-icon">‚ö†Ô∏è</span>
          <div class="alert-content">
            <h4 class="alert-title">Completa tu configuraci√≥n primero</h4>
            <p class="alert-text">Para activar el bot, debes completar al menos el 75% del onboarding (men√∫ configurado y mensajes personalizados).</p>
          </div>
        </div>
      </div>

      <!-- Stats Cards Grid (mantener IDs originales) -->
      <div id="completion-container" style="display: none;">
        <div class="stats-grid-modern">
          <div class="stat-card-modern stat-primary">
            <div class="stat-header">
              <span class="stat-label">Total Proyectos</span>
              <button class="stat-action">‚Üó</button>
            </div>
            <div class="stat-value" id="orders-today">24</div>
            <div class="stat-footer">
              <span class="stat-trend positive">
                <span>‚Üó</span>
                <span>Incremento desde el mes pasado</span>
              </span>
            </div>
          </div>

          <div class="stat-card-modern">
            <div class="stat-header">
              <span class="stat-label">Proyectos Terminados</span>
              <button class="stat-action">‚Üó</button>
            </div>
            <div class="stat-value">10</div>
            <div class="stat-footer">
              <span class="stat-trend positive">
                <span>‚Üó</span>
                <span>Incremento desde el mes pasado</span>
              </span>
            </div>
          </div>

          <div class="stat-card-modern">
            <div class="stat-header">
              <span class="stat-label">Proyectos en Curso</span>
              <button class="stat-action">‚Üó</button>
            </div>
            <div class="stat-value" id="sales-today">12</div>
            <div class="stat-footer">
              <span class="stat-trend positive">
                <span>‚Üó</span>
                <span>Incremento desde el mes pasado</span>
              </span>
            </div>
          </div>

          <div class="stat-card-modern">
            <div class="stat-header">
              <span class="stat-label">Proyectos Pendientes</span>
              <button class="stat-action">‚Üó</button>
            </div>
            <div class="stat-value">2</div>
            <div class="stat-footer">
              <span class="stat-trend">En Discusi√≥n</span>
            </div>
          </div>
        </div>

        <!-- Main Grid: Analytics + Reminders + Projects -->
        <div class="content-grid">
          <!-- Analytics Chart -->
          <div class="card-modern card-analytics">
            <div class="card-header-modern">
              <h3 class="card-title-modern">Anal√≠tica del Proyecto</h3>
            </div>
            <div class="card-body-modern">
              <div class="chart-bars">
                <div class="chart-bar" style="--height: 40%; --day: 'L'"></div>
                <div class="chart-bar active" style="--height: 75%; --day: 'M'"></div>
                <div class="chart-bar" style="--height: 55%; --day: 'M'"></div>
                <div class="chart-bar active" style="--height: 95%; --day: 'J'"></div>
                <div class="chart-bar" style="--height: 30%; --day: 'V'"></div>
                <div class="chart-bar" style="--height: 45%; --day: 'S'"></div>
                <div class="chart-bar" style="--height: 60%; --day: 'D'"></div>
              </div>
            </div>
          </div>

          <!-- Reminders -->
          <div class="card-modern card-reminders">
            <div class="card-header-modern">
              <h3 class="card-title-modern">Recordatorios</h3>
            </div>
            <div class="card-body-modern">
              <div class="reminder-item">
                <h4 class="reminder-title">Reuni√≥n con Empresa Arco</h4>
                <p class="reminder-time">Hora: 02:00 pm - 04:00 pm</p>
                <button class="reminder-btn">
                  <span>üìπ</span>
                  <span>Iniciar Reuni√≥n</span>
                </button>
              </div>
            </div>
          </div>

          <!-- Projects List -->
          <div class="card-modern card-projects">
            <div class="card-header-modern">
              <h3 class="card-title-modern">Proyectos</h3>
              <button class="btn-icon-modern" onclick="openMenuConfig()">+ Nuevo</button>
            </div>
            <div class="card-body-modern">
              <div class="project-item">
                <span class="project-icon" style="background: #667eea;">‚ö°</span>
                <div class="project-info">
                  <h4 class="project-title">Desarrollo API Endpoints</h4>
                  <p class="project-date">Vencimiento: Nov 26, 2024</p>
                </div>
              </div>
              <div class="project-item">
                <span class="project-icon" style="background: #57cc99;">üìã</span>
                <div class="project-info">
                  <h4 class="project-title">Flujo de Onboarding</h4>
                  <p class="project-date">Vencimiento: Nov 28, 2024</p>
                </div>
              </div>
              <div class="project-item">
                <span class="project-icon" style="background: #fb923c;">üé®</span>
                <div class="project-info">
                  <h4 class="project-title">Construir Dashboard</h4>
                  <p class="project-date">Vencimiento: Nov 30, 2024</p>
                </div>
              </div>
              <div class="project-item">
                <span class="project-icon" style="background: #f59e0b;">‚ö°</span>
                <div class="project-info">
                  <h4 class="project-title">Optimizar Carga de P√°gina</h4>
                  <p class="project-date">Vencimiento: Dic 04, 2024</p>
                </div>
              </div>
              <div class="project-item">
                <span class="project-icon" style="background: #8b5cf6;">üß™</span>
                <div class="project-info">
                  <h4 class="project-title">Pruebas Cross-Browser</h4>
                  <p class="project-date">Vencimiento: Dic 06, 2024</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Bottom Grid: Team + Progress + Timer -->
        <div class="bottom-grid">
          <!-- Team Collaboration -->
          <div class="card-modern card-team">
            <div class="card-header-modern">
              <h3 class="card-title-modern">Colaboraci√≥n del Equipo</h3>
              <button class="btn-icon-modern">+ Agregar Miembro</button>
            </div>
            <div class="card-body-modern">
              <div class="team-member">
                <img src="https://ui-avatars.com/api/?name=Alexandra+Deff&background=1a5f7a&color=fff" alt="Alexandra" class="member-avatar">
                <div class="member-info">
                  <h4 class="member-name">Alexandra Deff</h4>
                  <p class="member-task">Trabajando en <span>Repositorio de Proyectos Github</span></p>
                </div>
                <span class="member-status status-completed">Completado</span>
              </div>
              <div class="team-member">
                <img src="https://ui-avatars.com/api/?name=Edwin+Adenike&background=f59e0b&color=fff" alt="Edwin" class="member-avatar">
                <div class="member-info">
                  <h4 class="member-name">Edwin Adenike</h4>
                  <p class="member-task">Trabajando en <span>Sistema de Autenticaci√≥n de Usuario Integrado</span></p>
                </div>
                <span class="member-status status-progress">En Progreso</span>
              </div>
              <div class="team-member">
                <img src="https://ui-avatars.com/api/?name=Isaac+Oluwatemilrun&background=8b5cf6&color=fff" alt="Isaac" class="member-avatar">
                <div class="member-info">
                  <h4 class="member-name">Isaac Oluwatemilrun</h4>
                  <p class="member-task">Trabajando en <span>Desarrollo B√∫squeda y Funcionalidad Filtro</span></p>
                </div>
                <span class="member-status status-pending">Pendiente</span>
              </div>
              <div class="team-member">
                <img src="https://ui-avatars.com/api/?name=David+Oshodi&background=f59e0b&color=fff" alt="David" class="member-avatar">
                <div class="member-info">
                  <h4 class="member-name">David Oshodi</h4>
                  <p class="member-task">Trabajando en <span>Layout Responsivo para Homepage</span></p>
                </div>
                <span class="member-status status-progress">En Progreso</span>
              </div>
            </div>
          </div>

          <!-- Progress Chart -->
          <div class="card-modern card-progress">
            <div class="card-header-modern">
              <h3 class="card-title-modern">Progreso del Proyecto</h3>
            </div>
            <div class="card-body-modern">
              <div class="progress-circle">
                <svg viewBox="0 0 36 36" class="circular-chart">
                  <path class="circle-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
                  <path class="circle" stroke-dasharray="41, 100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
                </svg>
                <div class="progress-text">
                  <span class="progress-value">41%</span>
                  <span class="progress-label">Proyecto Terminado</span>
                </div>
              </div>
              <div class="progress-legend">
                <div class="legend-item">
                  <span class="legend-dot" style="background: #57cc99;"></span>
                  <span>Completado</span>
                </div>
                <div class="legend-item">
                  <span class="legend-dot" style="background: #1a5f7a;"></span>
                  <span>En Progreso</span>
                </div>
                <div class="legend-item">
                  <span class="legend-dot" style="background: #e5e7eb;"></span>
                  <span>Pendiente</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Time Tracker -->
          <div class="card-modern card-timer">
            <div class="card-header-modern">
              <h3 class="card-title-modern">Rastreador de Tiempo</h3>
            </div>
            <div class="card-body-modern">
              <div class="timer-display">01:24:08</div>
              <div class="timer-controls">
                <button class="timer-btn timer-pause">
                  <span>‚è∏</span>
                </button>
                <button class="timer-btn timer-stop">
                  <span>‚èπ</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Wizard (mantener IDs y estructura original) -->
      <div id="wizard-container" style="display: none;">
        <div class="wizard-modern">
          <div class="wizard-header-modern">
            <h1 class="wizard-title-modern">üöÄ ¬°Bienvenido a KDS Platform!</h1>
            <p class="wizard-subtitle-modern">Completa estos pasos para empezar a recibir pedidos autom√°ticamente</p>
          </div>

          <!-- Progress (mantener IDs originales) -->
          <div class="progress-modern">
            <div class="progress-info">
              <span>Tu progreso</span>
              <span class="progress-percent" id="progress-percentage">25%</span>
            </div>
            <div class="progress-bar-modern">
              <div class="progress-fill-modern" id="progress-fill" style="width: 25%"></div>
            </div>
          </div>

          <!-- Steps (mantener IDs y onclicks originales) -->
          <div class="steps-modern">
            <div class="step-modern completed" id="step-1">
              <div class="step-icon-modern">‚úÖ</div>
              <div class="step-content-modern">
                <h3 class="step-title-modern">1. Conectar WhatsApp</h3>
                <p class="step-desc-modern">Tu n√∫mero de WhatsApp Business est√° conectado y listo</p>
              </div>
              <span class="step-status-modern">Completado</span>
            </div>

            <div class="step-modern" id="step-2">
              <div class="step-icon-modern">üçΩÔ∏è</div>
              <div class="step-content-modern">
                <h3 class="step-title-modern">2. Configurar tu men√∫</h3>
                <p class="step-desc-modern">Agrega los productos que tus clientes pueden ordenar (5 min)</p>
              </div>
              <button class="step-btn-modern" onclick="openMenuConfig()">Configurar ‚Üí</button>
            </div>

            <div class="step-modern" id="step-3">
              <div class="step-icon-modern">üí¨</div>
              <div class="step-content-modern">
                <h3 class="step-title-modern">3. Personalizar mensajes</h3>
                <p class="step-desc-modern">Ajusta los mensajes autom√°ticos que env√≠a el bot (3 min)</p>
              </div>
              <button class="step-btn-modern" onclick="openMessagesConfig()">Personalizar ‚Üí</button>
            </div>

            <div class="step-modern" id="step-4">
              <div class="step-icon-modern">üß™</div>
              <div class="step-content-modern">
                <h3 class="step-title-modern">4. Probar el bot</h3>
                <p class="step-desc-modern">Env√≠a un mensaje de prueba para ver c√≥mo funciona (2 min)</p>
              </div>
              <button class="step-btn-modern" onclick="openTestBot()">Probar ‚Üí</button>
            </div>
          </div>

          <button class="wizard-skip-modern" onclick="skipOnboarding()">Saltar por ahora, explorar por mi cuenta</button>
        </div>
      </div>
    </div>
  </main>

  <!-- Modals (mantener estructura e IDs originales) -->
  <!-- Modal: Menu Config -->
  <div class="modal-overlay" id="menu-modal">
    <div class="modal-modern">
      <div class="modal-header-modern">
        <h2 class="modal-title-modern">üçΩÔ∏è Configurar Men√∫</h2>
        <button class="modal-close-modern" onclick="closeMenuModal()">√ó</button>
      </div>
      <div class="modal-body-modern">
        <p class="modal-desc">Agrega los productos de tu men√∫. Los clientes podr√°n ordenarlos por WhatsApp.</p>

        <div class="form-group-modern">
          <label class="form-label-modern">Nombre del producto</label>
          <input type="text" class="form-input-modern" id="item-name" placeholder="Ej: Hamburguesa Cl√°sica">
        </div>

        <div class="form-group-modern">
          <label class="form-label-modern">Precio (COP)</label>
          <input type="number" class="form-input-modern" id="item-price" placeholder="25000">
        </div>

        <div class="form-group-modern">
          <label class="form-label-modern">Descripci√≥n (opcional)</label>
          <input type="text" class="form-input-modern" id="item-description" placeholder="Carne, lechuga, tomate...">
        </div>

        <div class="form-group-modern">
          <label class="form-label-modern">Categor√≠a</label>
          <select class="form-select-modern" id="item-category">
            <option value="Entradas">Entradas</option>
            <option value="Platos Principales">Platos Principales</option>
            <option value="Bebidas">Bebidas</option>
            <option value="Postres">Postres</option>
          </select>
        </div>

        <button class="btn-add-modern" onclick="addMenuItem()">+ Agregar producto</button>

        <div class="menu-items-modern" id="menu-items-list">
          <!-- Items se agregar√°n aqu√≠ -->
        </div>
      </div>
      <div class="modal-footer-modern">
        <button class="btn-secondary-modern" onclick="closeMenuModal()">Cancelar</button>
        <button class="btn-primary-modern" onclick="saveMenu()">Guardar Men√∫</button>
      </div>
    </div>
  </div>

  <!-- Modal: Messages Config (mantener estructura original pero no la incluyo completa por espacio) -->
  <div class="modal-overlay" id="messages-modal">
    <div class="modal-modern">
      <div class="modal-header-modern">
        <h2 class="modal-title-modern">üí¨ Personalizar Mensajes</h2>
        <button class="modal-close-modern" onclick="closeMessagesModal()">√ó</button>
      </div>
      <div class="modal-body-modern">
        <p class="modal-desc">Personaliza los mensajes autom√°ticos que env√≠a el bot a tus clientes.</p>
        
        <div class="form-group-modern">
          <label class="form-label-modern">Mensaje de Bienvenida</label>
          <textarea class="form-textarea-modern" id="welcome-message" rows="4" placeholder="¬°Hola! Bienvenido a nuestro restaurante..."></textarea>
        </div>

        <div class="form-group-modern">
          <label class="form-label-modern">Mensaje de Confirmaci√≥n</label>
          <textarea class="form-textarea-modern" id="confirmation-message" rows="4" placeholder="Tu pedido ha sido confirmado..."></textarea>
        </div>
      </div>
      <div class="modal-footer-modern">
        <button class="btn-secondary-modern" onclick="closeMessagesModal()">Cancelar</button>
        <button class="btn-primary-modern" onclick="saveMessages()">Guardar Mensajes</button>
      </div>
    </div>
  </div>

  <!-- JavaScript (mantener referencias originales) -->
  <script src="js/dashboard.js"></script>
  
  <!-- Script adicional para manejar el toggle visual -->
  <script>
    // Mantener compatibilidad con toggle original
    const botToggle = document.getElementById('bot-toggle-input');
    const originalToggle = document.getElementById('bot-toggle');
    
    if (botToggle && originalToggle) {
      botToggle.addEventListener('change', function() {
        if (this.checked) {
          originalToggle.classList.add('active');
        } else {
          originalToggle.classList.remove('active');
        }
      });
    }

    // Sincronizar el bot-toggle antiguo con el nuevo
    window.toggleBot = function() {
      const checkbox = document.getElementById('bot-toggle-input');
      if (checkbox) {
        checkbox.checked = !checkbox.checked;
        checkbox.dispatchEvent(new Event('change'));
      }
      
      // Llamar a la funci√≥n original si existe
      if (window.originalToggleBot) {
        window.originalToggleBot();
      }
    };
  </script>
</body>
</html>
